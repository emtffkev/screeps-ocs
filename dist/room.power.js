const e={};module.exports=e,e.analyzeRoom=function(e,o){o&&e.savePowerSpawn(),e.structures.powerSpawn&&e.processPower()},e.extend=function(){Object.defineProperties(Room.prototype,{powerBank:{configurable:!0,get:function(){return _.isUndefined(this.memory.powerBank)&&([this._powerBank]=this.find(FIND_STRUCTURES,{filter:e=>e instanceof StructurePowerBank}),this._powerBank&&(this.memory.powerBank=this._powerBank.id)),_.isUndefined(this._powerBank)&&(this._powerBank=Game.getObjectById(this.memory.powerBank)),this._powerBank}}}),Room.PowerSpawn=function(e){this.room=e,Object.defineProperties(this,{all:{configurable:!0,get:function(){if(_.isUndefined(this._all)){this._all=[];let e=e=>{let o=Game.getObjectById(e.id);o&&(_.assign(o,e),this._all.push(o))};_.forEach(this.room.memory.powerSpawns,e)}return this._all}}})},Room.prototype.savePowerSpawn=function(){let e=this.find(FIND_MY_STRUCTURES,{filter:e=>e.structureType==STRUCTURE_POWER_SPAWN});if(e.length>0){this.memory.powerSpawns=[];let o=e=>{let o=this.memory.powerSpawns.find(o=>o.id==e.id);o||this.memory.powerSpawns.push({id:e.id})};e.forEach(o)}else delete this.memory.powerSpawns},Room.prototype.processPower=function(){let e=this.find(FIND_MY_STRUCTURES,{filter:e=>{return e.structureType==STRUCTURE_POWER_SPAWN}});for(var o=0;o<e.length;o++){let n=e[o];n.energy>=POWER_SPAWN_ENERGY_RATIO&&n.power>=1&&(global.DEBUG&&global.TRACE&&trace("Room",{roomName:this.name,actionName:"processPower"}),n.processPower())}}},e.flushRoom=function(e){e._powerBank||delete e.memory.powerBank};
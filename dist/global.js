const o=function(o,e,r){const t=Memory.debugTrace[r];return Memory.debugTrace.hasOwnProperty(r)?!!o&&(t===e||!e&&t===`${e}`):o},e=function(o){const e=Memory.debugTrace.no[o[0]];return e===!0||Memory.debugTrace.no.hasOwnProperty(o[0])&&(e===o[1]||!o[1]&&e===`${o[1]}`)};let r={};module.exports=r,r.LiteEvent=function(){this.handlers=[],this.on=function(o){this.handlers.push(o)},this.off=function(o){this.handlers=this.handlers.filter(e=>e!==o)},this.trigger=function(o){try{this.handlers.slice(0).forEach(e=>e(o))}catch(o){global.logError("Error in LiteEvent.trigger: "+(o.stack||o))}}},r.FLAG_COLOR={invade:{color:COLOR_RED,secondaryColor:COLOR_RED,exploit:{color:COLOR_RED,secondaryColor:COLOR_GREEN},robbing:{color:COLOR_RED,secondaryColor:COLOR_YELLOW},attackController:{color:COLOR_RED,secondaryColor:COLOR_CYAN}},labs:{color:COLOR_PURPLE,secondaryColor:COLOR_PURPLE,filter:{color:COLOR_PURPLE,secondaryColor:COLOR_PURPLE},labTech:{color:COLOR_PURPLE,secondaryColor:COLOR_WHITE,filter:{color:COLOR_PURPLE,secondaryColor:COLOR_WHITE}}},construct:{color:COLOR_CYAN,secondaryColor:COLOR_CYAN,spawn:{color:COLOR_CYAN,secondaryColor:COLOR_RED},tower:{color:COLOR_CYAN,secondaryColor:COLOR_PURPLE},link:{color:COLOR_CYAN,secondaryColor:COLOR_BLUE},lab:{color:COLOR_CYAN,secondaryColor:COLOR_GREEN},storage:{color:COLOR_CYAN,secondaryColor:COLOR_YELLOW},terminal:{color:COLOR_CYAN,secondaryColor:COLOR_ORANGE},observer:{color:COLOR_CYAN,secondaryColor:COLOR_BROWN},nuker:{color:COLOR_CYAN,secondaryColor:COLOR_GREY},powerSpawn:{color:COLOR_CYAN,secondaryColor:COLOR_WHITE}},claim:{color:COLOR_GREEN,secondaryColor:COLOR_GREEN,spawn:{color:COLOR_GREEN,secondaryColor:COLOR_WHITE},pioneer:{color:COLOR_GREEN,secondaryColor:COLOR_RED},reserve:{color:COLOR_GREEN,secondaryColor:COLOR_GREY},mining:{color:COLOR_GREEN,secondaryColor:COLOR_BROWN},delivery:{color:COLOR_GREEN,secondaryColor:COLOR_YELLOW}},defense:{color:COLOR_YELLOW,secondaryColor:COLOR_YELLOW},destroy:{color:COLOR_ORANGE,secondaryColor:COLOR_ORANGE,dismantle:{color:COLOR_ORANGE,secondaryColor:COLOR_YELLOW}},pavementArt:{color:COLOR_BROWN,secondaryColor:COLOR_BROWN},command:{color:COLOR_WHITE,drop:{color:COLOR_WHITE,secondaryColor:COLOR_YELLOW},_OCS:{color:COLOR_WHITE,secondaryColor:COLOR_PURPLE},roomLayout:{color:COLOR_WHITE,secondaryColor:COLOR_CYAN},invalidPosition:{color:COLOR_WHITE,secondaryColor:COLOR_RED},skipRoom:{color:COLOR_WHITE,secondaryColor:COLOR_GREEN}}},r.DECAY_AMOUNT={rampart:RAMPART_DECAY_AMOUNT,road:ROAD_DECAY_AMOUNT,container:CONTAINER_DECAY},r.DECAYABLES=[STRUCTURE_ROAD,STRUCTURE_CONTAINER,STRUCTURE_RAMPART],r.LAB_IDLE="idle",r.LAB_BOOST="boost",r.LAB_SEED="seed",r.LAB_MASTER="master",r.LAB_SLAVE_1="slave_1",r.LAB_SLAVE_2="slave_2",r.LAB_SLAVE_3="slave_3",r.REACTOR_TYPE_FLOWER="flower",r.REACTOR_MODE_IDLE="idle",r.REACTOR_MODE_BURST="burst",r.LAB_REACTIONS={};for(let t in REACTIONS)for(let n in REACTIONS[t])r.LAB_REACTIONS[REACTIONS[t][n]]=[t,n];r.MEM_SEGMENTS={COSTMATRIX_CACHE:{start:99,end:95}},r.translateErrorCode=function(o){var e={0:"OK",1:"ERR_NOT_OWNER",2:"ERR_NO_PATH",3:"ERR_NAME_EXISTS",4:"ERR_BUSY",5:"ERR_NOT_FOUND",6:"ERR_NOT_ENOUGH_RESOURCES",7:"ERR_INVALID_TARGET",8:"ERR_FULL",9:"ERR_NOT_IN_RANGE",10:"ERR_INVALID_ARGS",11:"ERR_TIRED",12:"ERR_NO_BODYPART",14:"ERR_RCL_NOT_ENOUGH",15:"ERR_GCL_NOT_ENOUGH"};return e[o*-1]},r.dye=function(o,e){if(isObj(o)){var r="",t=e=>r+=e+":"+o[e]+";";return _.forEach(Object.keys(o),t),'<font style="'+r+'">'+e+"</font>"}return o?'<font style="color:'+o+'">'+e+"</font>":e},r.CRAYON={death:{color:"black","font-weight":"bold"},birth:"#e6de99",error:"#e79da7",system:{color:"#999","font-size":"10px"}},r.logErrorCode=function(o,e){if(e){var r=translateErrorCode(e);o&&(r?o.say(r):o.say(e));var t=r+"\nroom: "+o.pos.roomName+"\ncreep: "+o.name+"\naction: "+o.data.actionName+"\ntarget: "+o.data.targetId;console.log(dye(CRAYON.error,t),Util.stack()),Game.notify(t,120)}else{var t="unknown error code\nroom: "+o.pos.roomName+"\ncreep: "+o.name+"\naction: "+o.data.actionName+"\ntarget: "+o.data.targetId;console.log(dye(CRAYON.error,t),Util.stack())}},r.logError=function(o,e){e?trace("error",e,dye(CRAYON.error,o)):console.log(dye(CRAYON.error,o),Util.stack())},r.trace=function(r,t,...n){if(!(Memory.debugTrace[r]!==!0&&_(t).reduce(o,1)!==!0||Memory.debugTrace.no&&_(t).pairs().some(e)===!0)){let o=n,e="";if(0===n.length&&r){let n=r;do e=n,n=t[n];while(t[n]&&n!=r);n&&n!=r&&(o="string"==typeof n?[n]:[e,"=",n])}console.log(Game.time,dye(CRAYON.error,r),...o,dye(CRAYON.birth,JSON.stringify(t)),Util.stack())}},r.logSystem=function(o,e){let r=dye(CRAYON.system,o);console.log(dye(CRAYON.system,`<a href="/a/#!/room/${o}">${r}</a> &gt; `)+e,Util.stack())},r.isObj=function(o){return null!==o&&("function"==typeof o||"object"==typeof o)},r.toLocalDate=function(o){o||(o=new Date);var e=TIME_ZONE;return USE_SUMMERTIME&&isSummerTime(o)&&e++,new Date(o.getTime()+36e5*e)},r.toDateTimeString=function(o){return len(o.getDate())+"."+len(o.getMonth()+1)+"."+len(o.getFullYear())+" "+len(o.getHours())+":"+len(o.getMinutes())+":"+len(o.getSeconds())},r.toTimeString=function(o){return len(o.getHours())+":"+len(o.getMinutes())+":"+len(o.getSeconds())},r.len=function(o){return("00"+o).slice(-2)},r.isSummerTime=function(o){var e=o.getFullYear(),r=new Date(e,2,31),t=new Date(e,2,r.getDate()-r.getDay(),2,0,0);r=new Date(e,9,31);var n=new Date(e,9,r.getDate()-r.getDay(),3,0,0);return t<o&&o<n},r.addById=function(o,e){null==o&&(o=[]);var r=Game.getObjectById(e);return r&&o.push(r),o},r.processReports=function(){if(!_.isUndefined(Memory.statistics)&&!_.isUndefined(Memory.statistics.reports)&&Memory.statistics.reports.length>0){let o;if(Memory.statistics.reports.length<=REPORTS_PER_LOOP)o=Memory.statistics.reports,Memory.statistics.reports=[];else{let e=_.chunk(Memory.statistics.reports,REPORTS_PER_LOOP);o=e[0],Memory.statistics.reports=_(e).tail().concat()}let e=o=>Game.notify(o);_.forEach(o,e)}},r.routeRange=function(o,e){if(o===e)return 0;if(_.isUndefined(Memory.routeRange)&&(Memory.routeRange={}),_.isUndefined(Memory.routeRange[o])&&(Memory.routeRange[o]={}),_.isUndefined(Memory.routeRange[o][e])){let r=null;if(r=o instanceof Room?o:Game.rooms[o],_.isUndefined(r))return Room.roomDistance(o,e,!1);let t=r.findRoute(e,!1,!1);if(_.isUndefined(t))return Room.roomDistance(o,e,!1);Memory.routeRange[o][e]=t==ERR_NO_PATH?1/0:t.length}return Memory.routeRange[o][e]},r.pave=function(o){let e=_.values(Game.flags).filter(e=>e.pos.roomName==o&&e.color==COLOR_BROWN),r=void 0===Memory.pavementArt[o]?"":Memory.pavementArt[o],t=o=>"x"+o.pos.x+"y"+o.pos.y;Memory.pavementArt[o]=r+e.map(t).join("")+"x";let n=o=>o.room.createConstructionSite(o,STRUCTURE_WALL);e.forEach(n);let O=o=>o.remove();e.forEach(O)},r.unpave=function(o){if(!Memory.pavementArt||!Memory.pavementArt[o])return!1;let e=Game.rooms[o];if(!e)return!1;let r=e=>Memory.pavementArt[o].indexOf("x"+e.pos.x+"y"+e.pos.y+"x")>=0,t=e.structures.all.filter(r),n=o=>o.destroy();return t&&t.forEach(n),delete Memory.pavementArt[o],!0},r.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var e=16*Math.random()|0,r="x"==o?e:3&e|8;return r.toString(16)})},Object.defineProperty(global,"observerRequests",{configurable:!0,get:function(){return Util.get(global,"_observerRequests",[])},set:function(o){Util.get(global,"_observerRequests",[]).push(o)}}),r=_.bindAll(r);